---
- name: Open firewall ports
  hosts: all
  gather_facts: yes
  become: yes
  vars:
    ports:
      - 2376/tcp
      - 2377/tcp
      - 4789/udp
      - 7946/tcp
      - 7946/udp
      - 9000/tcp
  tasks:
    - name: Install firewalld if it's not installed
      package:
        name: firewalld
        state: present

    - name: Ensure firewalld is running
      service:
        name: firewalld
        state: started
        enabled: yes

    - name: Open firewall ports
      firewalld:
        port: "{{ item }}"
        permanent: true
        state: enabled
      with_items: "{{ ports }}"
      notify: 
        - Reload firewalld

  handlers:
    - name: Reload firewalld
      command: firewall-cmd --reload
...
